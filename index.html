<!DOCTYPE html>
<html lang="en">
<head>
    <title>BoxDodge</title>
    <style>
        body, html { padding: 0; margin: 0; overflow: hidden; height: 100%; font-family: 'Raleway', cursive; }
        header { color: #151515; }
        header h1 { margin: 0; margin-left: 20px; }
        header p { margin: 0; margin-bottom: 10px; margin-left: 20px; padding: 0; }
        canvas { border: 10px solid black; background: skyblue; margin: 0 auto; }
    </style>
    <link href='http://fonts.googleapis.com/css?family=Raleway:100' rel='stylesheet' type='text/css'>
</head>
<body>
    <header>
        <h1>BoxDodge</h1>
        <p>Click the Box in the middle to begin. Use your mouse to dodge the other boxes and stay within the marked area for as long as possible.</p>
    </header>

    <article>
        <canvas id="canv" width="500" height="500"></canvas>
    </article>

    <article>
        <b>Co-ordinates:</b>
        <span id="x">0</span> <span> : </span>
        <span id="y">0</span>
    </article>

    <script>
        (function() {
            var context = canv.getContext('2d'), running = false, start = 0, stop = 0, time = 0, timer = null, tick = 0,
                // location of the shape
                x = [30, 150, 250, 400],
                y = [150, 30, 350, 120],
                // the "speed" in a direction for the shape
                a = [2, 5, 2, 5],
                b = [3, 2, 4, 2],
                // the bounding box, relative to each shape
                m = [0, 0, 0, 0],
                n = [450, 450, 450, 400],
                p = [0, 0, 0, 0],
                q = [450, 450, 450, 450],
                // size of box
                r = [60, 60, 60, 120],
                s = [60, 60, 60, 60],
                // the cursor details
                f = [225, 225, 60, 60];

            function t() { return new Date().getTime(); }
            function d() {
                context.clearRect(0, 0, 500, 500);
                tick++;

                // these are separate so c() isn't run every loop
                if (running === true) {
                    if (c()) {
                        clearInterval(timer);
                    }
                }

                context.fillStyle = "#47a875";
                context.beginPath();
                context.fillRect(f[0], f[1], f[2], f[3]);
                context.closePath();
                context.fill();

                context.fillStyle = "#4775a8";
                for (var i = 0; i < 4; i++) {
                    context.beginPath();
                    context.fillRect(x[i], y[i], r[i], s[i]);
                    context.closePath();
                    context.fill();

                    if (running === true && (tick % 4) === 0) {
                        if (x[i] < m[i] || x[i] > n[i])
                            a[i] = -a[i];
                        if (y[i] < p[i] || y[i] > q[i])
                            b[i] = -b[i];
                        x[i] += a[i];
                        y[i] += b[i];
                    }
                }
            }
            function c() {
                if (f[0] < 0 || f[0] > 440 ||
                    f[1] < 0 || f[1] > 440) {
                    console.log("You hit the wall!");
                    return true;
                }
            }

            canv.onmousemove = function(e) {
                mouse_x = e.pageX - 10;
                mouse_y = e.pageY - 75;

                mx = document.getElementById('x');
                my = document.getElementById('y');

                mx.innerHTML = mouse_x;
                my.innerHTML = mouse_y;

                f = [e.pageX - 10, e.pageY - 75, f[2], f[3]];
            }
            canv.onmouseout = function(e) {
                // cancel the whole thing
            }
            canv.onmousedown = function(e) {
                running = true;
                start = t();
            }
            timer = setInterval(d, 4);
        })();
    </script>
</body>
</html>
